<!--
@license
Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><html><head><link rel="import" href="../../polymer-element.html">
<link rel="import" href="../utils/templatize.html">
<link rel="import" href="../utils/debounce.html">
<link rel="import" href="../utils/flush.html">
<link rel="import" href="../mixins/mutable-data.html">

<script>(function(){'use strict';class c extends Polymer.OptionalMutableData(Polymer.Element){static get is(){return'dom-repeat'}static get template(){return null}static get properties(){return{items:{type:Array},as:{type:String,value:'item'},indexAs:{type:String,value:'index'},itemsIndexAs:{type:String,value:'itemsIndex'},sort:{type:Function,observer:'__sortChanged'},filter:{type:Function,observer:'__filterChanged'},observe:{type:String,observer:'__observeChanged'},delay:Number,renderedItemCount:{type:Number,notify:!0,readOnly:!0},initialCount:{type:Number,observer:'__initializeChunking'},targetFramerate:{type:Number,value:20},_targetFrameTime:{type:Number,computed:'__computeFrameTime(targetFramerate)'}}}static get observers(){return['__itemsChanged(items.*)']}constructor(){super(),this.__instances=[],this.__limit=Infinity,this.__pool=[],this.__renderDebouncer=null,this.__itemsIdxToInstIdx={},this.__chunkCount=null,this.__lastChunkTime=null,this.__needFullRefresh=!1,this.__sortFn=null,this.__filterFn=null,this.__observePaths=null,this.__ctor=null}disconnectedCallback(){super.disconnectedCallback(),this.__isDetached=!0;for(let d=0;d<this.__instances.length;d++)this.__detachInstance(d)}connectedCallback(){if(super.connectedCallback(),this.__isDetached){this.__isDetached=!1;let d=this.parentNode;for(let e=0;e<this.__instances.length;e++)this.__attachInstance(e,d)}}__ensureTemplatized(){if(!this.__ctor){let d=this.template=this.querySelector('template');if(!d){let f=new MutationObserver(()=>{if(this.querySelector('template'))f.disconnect(),this.__render();else throw new Error('dom-repeat requires a <template> child')});return f.observe(this,{childList:!0}),!1}let e={};e[this.as]=!0,e[this.indexAs]=!0,e[this.itemsIndexAs]=!0,this.__ctor=Polymer.Templatize.templatize(d,this,{mutableData:this.mutableData,parentModel:!0,instanceProps:e,forwardHostProp:function(f,g){let h=this.__instances;for(let k,j=0;j<h.length&&(k=h[j]);j++)k.forwardHostProp(f,g)},notifyInstanceProp:function(f,g,h){if(Polymer.Path.matches(this.as,g)){let j=f[this.itemsIndexAs];g==this.as&&(this.items[j]=h);let k=Polymer.Path.translate(this.as,'items.'+j,g);this.notifyPath(k,h)}}})}return!0}__getMethodHost(){return this.__dataHost._methodHost||this.__dataHost}__sortChanged(d){let e=this.__getMethodHost();this.__sortFn=d&&('function'==typeof d?d:function(){return e[d].apply(e,arguments)}),this.__needFullRefresh=!0,this.items&&this.__debounceRender(this.__render)}__filterChanged(d){let e=this.__getMethodHost();this.__filterFn=d&&('function'==typeof d?d:function(){return e[d].apply(e,arguments)}),this.__needFullRefresh=!0,this.items&&this.__debounceRender(this.__render)}__computeFrameTime(d){return Math.ceil(1e3/d)}__initializeChunking(){this.initialCount&&(this.__limit=this.initialCount,this.__chunkCount=this.initialCount,this.__lastChunkTime=performance.now())}__tryRenderChunk(){this.items&&this.__limit<this.items.length&&this.__debounceRender(this.__requestRenderChunk)}__requestRenderChunk(){requestAnimationFrame(()=>this.__renderChunk())}__renderChunk(){let d=performance.now(),e=this._targetFrameTime/(d-this.__lastChunkTime);this.__chunkCount=Math.round(this.__chunkCount*e)||1,this.__limit+=this.__chunkCount,this.__lastChunkTime=d,this.__debounceRender(this.__render)}__observeChanged(){this.__observePaths=this.observe&&this.observe.replace('.*','.').split(' ')}__itemsChanged(d){this.items&&!Array.isArray(this.items)&&console.warn('dom-repeat expected array for `items`, found',this.items),this.__handleItemPath(d.path,d.value)||(this.__needFullRefresh=!0,this.__initializeChunking(),this.__debounceRender(this.__render))}__handleObservedPaths(d){if(this.__observePaths){d=d.substring(d.indexOf('.')+1);let e=this.__observePaths;for(let f=0;f<e.length;f++)if(0===d.indexOf(e[f]))return this.__needFullRefresh=!0,this.__debounceRender(this.__render,this.delay),!0}}__debounceRender(d,e){this.__renderDebouncer=Polymer.Debouncer.debounce(this.__renderDebouncer,0<e?Polymer.Async.timeOut.after(e):Polymer.Async.microTask,d.bind(this)),Polymer.enqueueDebouncer(this.__renderDebouncer)}render(){this.__needFullRefresh=!0,this.__debounceRender(this.__render),Polymer.flush()}__render(){this.__ensureTemplatized()&&(this.__applyFullRefresh(),this.__pool.length=0,this._setRenderedItemCount(this.__instances.length),this.dispatchEvent(new CustomEvent('dom-change',{bubbles:!0,composed:!0})),this.__tryRenderChunk())}__applyFullRefresh(){const d=this.items||[];let e=Array(d.length);for(let j=0;j<d.length;j++)e[j]=j;this.__filterFn&&(e=e.filter((j,k,l)=>this.__filterFn(d[j],k,l))),this.__sortFn&&e.sort((j,k)=>this.__sortFn(d[j],d[k]));const f=this.__itemsIdxToInstIdx={};let g=0;for(const h=Math.min(e.length,this.__limit);g<h;g++){let j=this.__instances[g],k=e[g],l=d[k];f[k]=g,j&&g<this.__limit?(j._setPendingProperty(this.as,l),j._setPendingProperty(this.indexAs,g),j._setPendingProperty(this.itemsIndexAs,k),j._flushProperties()):this.__insertInstance(l,g,k)}for(let j=this.__instances.length-1;j>=g;j--)this.__detachAndRemoveInstance(j)}__detachInstance(d){let e=this.__instances[d];for(let g,f=0;f<e.children.length;f++)g=e.children[f],e.root.appendChild(g);return e}__attachInstance(d,e){let f=this.__instances[d];e.insertBefore(f.root,this)}__detachAndRemoveInstance(d){let e=this.__detachInstance(d);e&&this.__pool.push(e),this.__instances.splice(d,1)}__stampInstance(d,e,f){let g={};return g[this.as]=d,g[this.indexAs]=e,g[this.itemsIndexAs]=f,new this.__ctor(g)}__insertInstance(d,e,f){let g=this.__pool.pop();g?(g._setPendingProperty(this.as,d),g._setPendingProperty(this.indexAs,e),g._setPendingProperty(this.itemsIndexAs,f),g._flushProperties()):g=this.__stampInstance(d,e,f);let h=this.__instances[e+1],j=h?h.children[0]:this;return this.parentNode.insertBefore(g.root,j),this.__instances[e]=g,g}_showHideChildren(d){for(let e=0;e<this.__instances.length;e++)this.__instances[e]._showHideChildren(d)}__handleItemPath(d,e){let f=d.slice(6),g=f.indexOf('.'),h=0>g?f:f.substring(0,g);if(h==parseInt(h,10)){let j=0>g?'':f.substring(g+1);if(!this.__handleObservedPaths(j)){let k=this.__itemsIdxToInstIdx[h],l=this.__instances[k];if(l){let m=this.as+(j?'.'+j:'');l._setPendingPropertyOrPath(m,e,!1,!0),l._flushProperties()}}return!0}}itemForElement(d){let e=this.modelForElement(d);return e&&e[this.as]}indexForElement(d){let e=this.modelForElement(d);return e&&e[this.indexAs]}modelForElement(d){return Polymer.Templatize.modelForElement(this.template,d)}}customElements.define(c.is,c),Polymer.DomRepeat=c})();</script>
</head><body></body></html>